<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <!--DEPENDENCIES-->
   {% load static %}
   <link rel="stylesheet" type="text/css" href="{% static 'src/scss/global/global.css' %}" />
   <!--APP-->
   <link rel="stylesheet" type="text/css" href="{% static 'src/scss/app/file-management.css' %}" />

   <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
   <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
   <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
   <script>
      $(function () {
         $("#datepicker-start").datepicker();
      });
      $(function () {
         $("#datepicker-end").datepicker();
      });
   </script>
   <style>
      .ui-widget-header {
         background: #ddd;
      }
   </style>
   <script src="https://code.iconify.design/2/2.1.2/iconify.min.js"></script>
   <title>Document</title>
</head>

<body>

   <div class="global--container">
      <!--SIDEBAR-->
      <aside class="aside" id="aside">
         <div class="aside--container">
            <div class="aside--inner-container">
               <div class="sidebar--toggle-container">
                  <span class="sidebar--toggle" id="sidebar--toggle">
                     <div class="icon--open">
                        <svg width="16" height="16" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path
                              d="M14.75 2.25H1.25C1.05109 2.25 0.860319 2.17098 0.719667 2.03033C0.579015 1.88968 0.499998 1.69891 0.499998 1.5C0.499998 1.30109 0.579015 1.11032 0.719667 0.96967C0.860319 0.829018 1.05109 0.75 1.25 0.75H14.75C14.9489 0.75 15.1397 0.829018 15.2803 0.96967C15.421 1.11032 15.5 1.30109 15.5 1.5C15.5 1.69891 15.421 1.88968 15.2803 2.03033C15.1397 2.17098 14.9489 2.25 14.75 2.25ZM14.75 5.25H4.25C4.05109 5.25 3.86032 5.17098 3.71967 5.03033C3.57901 4.88968 3.5 4.69891 3.5 4.5C3.5 4.30109 3.57901 4.11032 3.71967 3.96967C3.86032 3.82902 4.05109 3.75 4.25 3.75H14.75C14.9489 3.75 15.1397 3.82902 15.2803 3.96967C15.421 4.11032 15.5 4.30109 15.5 4.5C15.5 4.69891 15.421 4.88968 15.2803 5.03033C15.1397 5.17098 14.9489 5.25 14.75 5.25ZM1.25 6.75H14.75C14.9489 6.75 15.1397 6.82902 15.2803 6.96967C15.421 7.11032 15.5 7.30109 15.5 7.5C15.5 7.69891 15.421 7.88968 15.2803 8.03033C15.1397 8.17098 14.9489 8.25 14.75 8.25H1.25C1.05109 8.25 0.860319 8.17098 0.719667 8.03033C0.579015 7.88968 0.499998 7.69891 0.499998 7.5C0.499998 7.30109 0.579015 7.11032 0.719667 6.96967C0.860319 6.82902 1.05109 6.75 1.25 6.75ZM4.25 9.75H14.75C14.9489 9.75 15.1397 9.82902 15.2803 9.96967C15.421 10.1103 15.5 10.3011 15.5 10.5C15.5 10.6989 15.421 10.8897 15.2803 11.0303C15.1397 11.171 14.9489 11.25 14.75 11.25H4.25C4.05109 11.25 3.86032 11.171 3.71967 11.0303C3.57901 10.8897 3.5 10.6989 3.5 10.5C3.5 10.3011 3.57901 10.1103 3.71967 9.96967C3.86032 9.82902 4.05109 9.75 4.25 9.75Z"
                              fill="#272727" />
                        </svg>
                     </div>
                     <div class="icon--close">
                        <svg width="16" height="16" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path
                              d="M1 9.5H13C13.4125 9.5 13.75 9.1625 13.75 8.75C13.75 8.3375 13.4125 8 13 8H1C0.5875 8 0.25 8.3375 0.25 8.75C0.25 9.1625 0.5875 9.5 1 9.5ZM1 5.75H13C13.4125 5.75 13.75 5.4125 13.75 5C13.75 4.5875 13.4125 4.25 13 4.25H1C0.5875 4.25 0.25 4.5875 0.25 5C0.25 5.4125 0.5875 5.75 1 5.75ZM0.25 1.25C0.25 1.6625 0.5875 2 1 2H13C13.4125 2 13.75 1.6625 13.75 1.25C13.75 0.8375 13.4125 0.5 13 0.5H1C0.5875 0.5 0.25 0.8375 0.25 1.25Z"
                              fill="#323232" />
                        </svg>
                     </div>
                  </span>
                  <p>Menu</p>
               </div>
               <div class="profile">
                  <div class="profile--image">
                     <a href="templates-for-project/profile.html" class="">
                        <img src="{% static 'src/images/profile-image.png' %}" alt="profile-image">
                     </a>
                  </div>
                  <div class="profile--name">
                     <h4 class="h4">Joy Francisco</h4>
                  </div>
               </div>
               <div class="menu">
                  <ul class="menu--links">

                     <li class="active">
                        <a href="">
                           <div class="icon">
                              <svg width="20" height="20" viewBox="0 0 18 14" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                 <path
                                    d="M7.731 0.51625C7.389 0.18375 6.93 0 6.453 0H1.8C0.81 0 0.00899999 0.7875 0.00899999 1.75L0 12.25C0 13.2125 0.81 14 1.8 14H16.2C17.19 14 18 13.2125 18 12.25V3.5C18 2.5375 17.19 1.75 16.2 1.75H9L7.731 0.51625Z"
                                    fill="#272727" />
                              </svg>
                           </div>
                           <span>File Management</span>
                        </a>
                     </li>
                     <li>
                        <a href="">
                           <div class="icon">
                              <svg width="20" height="20" viewBox="0 0 18 18" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                 <path
                                    d="M9 0C4.032 0 0 4.032 0 9C0 13.968 4.032 18 9 18C13.968 18 18 13.968 18 9C18 4.032 13.968 0 9 0ZM9 2.7C10.494 2.7 11.7 3.906 11.7 5.4C11.7 6.894 10.494 8.1 9 8.1C7.506 8.1 6.3 6.894 6.3 5.4C6.3 3.906 7.506 2.7 9 2.7ZM9 15.48C6.75 15.48 4.761 14.328 3.6 12.582C3.627 10.791 7.2 9.81 9 9.81C10.791 9.81 14.373 10.791 14.4 12.582C13.239 14.328 11.25 15.48 9 15.48Z"
                                    fill="#272727" />
                              </svg>
                           </div>
                           <span>Accounts</span>
                        </a>
                     </li>
                     <li>
                        <a href="">
                           <div class="icon">
                              <svg width="18" height="21" viewBox="0 0 18 21" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                 <path
                                    d="M4.49995 3.37503V2.24992H6.74997C6.74997 1.44611 7.17862 0.703334 7.87489 0.301427C8.571 -0.100476 9.42867 -0.100476 10.1247 0.301427C10.821 0.703329 11.2498 1.44611 11.2498 2.24992H13.4999L13.4997 3.37503C13.4997 3.67335 13.3812 3.95943 13.1703 4.17036C12.9593 4.38148 12.6731 4.49994 12.3748 4.49994H5.62487C5.32655 4.49994 5.04029 4.38148 4.82935 4.17036C4.61842 3.95943 4.49995 3.67333 4.49995 3.37503ZM15.1874 2.30682L15.1872 3.37503C15.1865 4.12065 14.8898 4.83556 14.3625 5.36273C13.8354 5.89009 13.1205 6.1865 12.3748 6.18742H5.62496C4.87934 6.18648 4.16443 5.89004 3.63727 5.36273C3.10991 4.83556 2.8133 4.12065 2.81258 3.37503V2.30682C2.02723 2.43809 1.31382 2.84358 0.798897 3.45092C0.283977 4.05851 0.000916055 4.82857 0 5.62486V16.875C0 17.7699 0.355574 18.6284 0.988568 19.2614C1.62156 19.8944 2.48 20.2499 3.37494 20.2499H14.6251C15.52 20.2499 16.3784 19.8944 17.0114 19.2614C17.6444 18.6284 18 17.7699 18 16.875V5.62486C17.9991 4.82857 17.716 4.05851 17.2011 3.45092C16.6862 2.84353 15.9728 2.43805 15.1874 2.30682Z"
                                    fill="#272727" />
                              </svg>
                           </div>
                           <span>Activity Logs</span>
                        </a>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="aside--bottom">
               <div class="logout-btn">
                  <a href="">
                     <div class="icon">
                        <svg width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M6.56305 18.1811C7.08007 18.1811 7.50107 18.5892 7.50107 19.0905C7.50107 19.592 7.08007 20 6.56305 20H2.81245C2.43512 20 2.06696 19.9278 1.72222 19.7877C1.3868 19.6538 1.08703 19.4595 0.827711 19.2126C0.569998 18.9641 0.36496 18.675 0.223661 18.3528C0.0745051 18.017 0 17.6617 0 17.2957V2.72827C0 2.35931 0.0745052 2.0025 0.222059 1.6667C0.363358 1.34149 0.566791 1.04943 0.823055 0.799414C1.08237 0.549544 1.38214 0.352299 1.71756 0.215301C2.0655 0.0736463 2.43352 0 2.81245 0H6.56305C7.08007 0 7.50107 0.408034 7.50107 0.909328C7.50107 1.41232 7.08007 1.8188 6.56305 1.8188H2.81245C2.29528 1.8188 1.87443 2.22683 1.87443 2.72827V17.2957C1.87443 17.7836 2.29528 18.1811 2.81245 18.1811L6.56305 18.1811ZM17.5824 9.20589C17.837 9.37308 18 9.64397 18 9.99938C18 10.3577 17.837 10.6272 17.5824 10.7944L14.686 13.6025C14.2838 13.9909 13.6813 13.9909 13.2805 13.6025C12.8783 13.2125 12.8783 12.6283 13.2805 12.2399L14.5851 10.9736H7.95864C7.35604 10.9736 6.95383 10.585 6.95383 9.99935C6.95383 9.41664 7.35604 9.02667 7.95864 9.02667H14.5851L13.2805 7.76193C12.8783 7.37195 12.8783 6.7877 13.2805 6.39772C13.6813 6.00775 14.2838 6.00775 14.686 6.39772L17.5824 9.20589Z"
                              fill="#272727" />
                        </svg>
                     </div>
                     <span>Logout</span>
                  </a>
               </div>
            </div>
         </div>
      </aside>
      <!--MAIN-->
      <main id="main-content">
         <section class="file-management">
            <div class="file-management--container">


               <div class="file-management--header">
                  <h2 class="h2 text-purple">File Management</h2>
                  <div class="cta--categories">
                     <a href="" class="btn btn-black">Manage Categories</a>
                  </div>
               </div>

               <div class="file-management--categories">

                  {% for category in category_list %}
                  <div class="file-management--categories_card">
                     <div class="icon-file">
                        <svg width="20" height="25" viewBox="0 0 20 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path
                              d="M13.2375 0.7375C12.7625 0.2625 12.125 0 11.4625 0H2.5C1.125 0 0 1.125 0 2.5V22.5C0 23.875 1.1125 25 2.4875 25H17.5C18.875 25 20 23.875 20 22.5V8.5375C20 7.875 19.7375 7.2375 19.2625 6.775L13.2375 0.7375ZM13.75 20H6.25C5.5625 20 5 19.4375 5 18.75C5 18.0625 5.5625 17.5 6.25 17.5H13.75C14.4375 17.5 15 18.0625 15 18.75C15 19.4375 14.4375 20 13.75 20ZM13.75 15H6.25C5.5625 15 5 14.4375 5 13.75C5 13.0625 5.5625 12.5 6.25 12.5H13.75C14.4375 12.5 15 13.0625 15 13.75C15 14.4375 14.4375 15 13.75 15ZM11.25 7.5V6.73636C11.25 4.9424 13.419 4.04398 14.6875 5.3125C15.956 6.58102 15.0576 8.75 13.2636 8.75H12.5C11.8125 8.75 11.25 8.1875 11.25 7.5Z"
                              fill="black" fill-opacity="0.5" />
                        </svg>
                     </div>
                     <h2> {{ category.title }}</h2>
                     <p class="fw-700 text-white">{{ category.file_set.count}} Files</p>
                  </div>
                  {% endfor %}

                  {% comment %} <div class="file-management--categories_grading-sheets">
                     <div class="icon-file">
                        <svg width="20" height="25" viewBox="0 0 20 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path
                              d="M13.2375 0.7375C12.7625 0.2625 12.125 0 11.4625 0H2.5C1.125 0 0 1.125 0 2.5V22.5C0 23.875 1.1125 25 2.4875 25H17.5C18.875 25 20 23.875 20 22.5V8.5375C20 7.875 19.7375 7.2375 19.2625 6.775L13.2375 0.7375ZM13.75 20H6.25C5.5625 20 5 19.4375 5 18.75C5 18.0625 5.5625 17.5 6.25 17.5H13.75C14.4375 17.5 15 18.0625 15 18.75C15 19.4375 14.4375 20 13.75 20ZM13.75 15H6.25C5.5625 15 5 14.4375 5 13.75C5 13.0625 5.5625 12.5 6.25 12.5H13.75C14.4375 12.5 15 13.0625 15 13.75C15 14.4375 14.4375 15 13.75 15ZM11.25 7.5V6.73636C11.25 4.9424 13.419 4.04398 14.6875 5.3125C15.956 6.58102 15.0576 8.75 13.2636 8.75H12.5C11.8125 8.75 11.25 8.1875 11.25 7.5Z"
                              fill="black" fill-opacity="0.5" />
                        </svg>
                     </div>
                     <h2>Grading Sheets</h2>
                     <p class="fw-700 text-white">10 Files</p>
                  </div>
                  <div class="file-management--categories_other-files">
                     <div class="icon-file">
                        <svg width="20" height="25" viewBox="0 0 20 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <path
                              d="M13.2375 0.7375C12.7625 0.2625 12.125 0 11.4625 0H2.5C1.125 0 0 1.125 0 2.5V22.5C0 23.875 1.1125 25 2.4875 25H17.5C18.875 25 20 23.875 20 22.5V8.5375C20 7.875 19.7375 7.2375 19.2625 6.775L13.2375 0.7375ZM13.75 20H6.25C5.5625 20 5 19.4375 5 18.75C5 18.0625 5.5625 17.5 6.25 17.5H13.75C14.4375 17.5 15 18.0625 15 18.75C15 19.4375 14.4375 20 13.75 20ZM13.75 15H6.25C5.5625 15 5 14.4375 5 13.75C5 13.0625 5.5625 12.5 6.25 12.5H13.75C14.4375 12.5 15 13.0625 15 13.75C15 14.4375 14.4375 15 13.75 15ZM11.25 7.5V6.73636C11.25 4.9424 13.419 4.04398 14.6875 5.3125C15.956 6.58102 15.0576 8.75 13.2636 8.75H12.5C11.8125 8.75 11.25 8.1875 11.25 7.5Z"
                              fill="black" fill-opacity="0.5" />
                        </svg>
                     </div>
                     <h2>Other Files</h2>
                     <p class="fw-700 text-white">12 Files</p>
                  </div> {% endcomment %}
               </div>

               <div class="component1">
                  <h4 class="h4"><a href="{% url 'file-management:index' %}">Uploaded Files</a></h4>
                  <h4 class="h4 active"><a href="{% url 'file-management:archive-index' %}">Archived</a></h4>
               </div>


               <div class="file-management--controls">
                  <div class="file-management--controls_left">
                     <div>
                        <p class="text-black text-small">Category</p>
                        <div class="component4">
                           <select onchange="location = this.value;">
                              {% if category_list %}
                           
                                 <option value="{% url 'file-management:filter' 0 sort_selected %}" {% if category_selected == 0 %} selected {%endif%} >All</option>

                                 {% for category in category_list %}
                                 <option value="{% url 'file-management:filter' category.id sort_selected %}" {% if category_selected == category.id %} selected {%endif%}>{{category.title}}</option>
                                 {% endfor %}

                              {% else %}
                                 <option value="{% url 'file-management:filter' 0 sort_selected %}" {% if category_selected == 0 %} selected {%endif%} >No categories yet</option></a>
                              {% endif %}
                           </select>
                        </div>
                     </div>
                     <div>
                        <p class="text-black text-small">Sort by</p>
                        <div class="component4">
                           <select onchange="location = this.value;">
                              <option value="{% url 'file-management:filter' category_selected 1 %}" {% if sort_selected == 1 %} selected {%endif%} >Name</option>
                              <option value="{% url 'file-management:filter' category_selected 2 %}" {% if sort_selected == 2 %} selected {%endif%} >Category</option>
                              <option value="{% url 'file-management:filter' category_selected 3 %}" {% if sort_selected == 3 %} selected {%endif%} >Uploader</option>
                              <option value="{% url 'file-management:filter' category_selected 4 %}" {% if sort_selected == 4 %} selected {%endif%} >Date uploaded</option>
                           </select>
                        </div>
                     </div>
                     <div>
                        <p class="text-black text-small">Date uploaded</p>
                        <div class="component2">
                           <div class="start-date">
                              <input type="text" id="datepicker-start">
                           </div>
                           -
                           <div class="end-date">
                              <input type="text" id="datepicker-end">
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="file-management--controls_right">
                     <div class="component3">
                        <div class="icon">
                           <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                              xmlns="http://www.w3.org/2000/svg">
                              <path
                                 d="M10.9167 9.66667H10.2583L10.025 9.44167C10.8417 8.49167 11.3333 7.25833 11.3333 5.91667C11.3333 2.925 8.90833 0.5 5.91667 0.5C2.925 0.5 0.5 2.925 0.5 5.91667C0.5 8.90833 2.925 11.3333 5.91667 11.3333C7.25833 11.3333 8.49167 10.8417 9.44167 10.025L9.66667 10.2583V10.9167L13.8333 15.075L15.075 13.8333L10.9167 9.66667ZM5.91667 9.66667C3.84167 9.66667 2.16667 7.99167 2.16667 5.91667C2.16667 3.84167 3.84167 2.16667 5.91667 2.16667C7.99167 2.16667 9.66667 3.84167 9.66667 5.91667C9.66667 7.99167 7.99167 9.66667 5.91667 9.66667Z"
                                 fill="#AAAAAA" />
                           </svg>
                        </div>
                        <input id="search" type="text" class="search-input" placeholder="Search" value="{{ search_value }}">
                     </div>
                  </div>
               </div>

               <div class="file-management--table-container">
                  
                  {% if file_list %}
                  <table>
                     <thead>
                        <tr>
                           <th scope="col">Name</th>
                           <th scope="col">Category</th>
                           <th scope="col">Uploader</th>
                           <th scope="col">Uploaded</th>
                           <th scope="col">Actions</th>
                        </tr>
                     </thead>
                     <tbody>
                        {% for file in file_list %}
                        <tr>
                           <td data-label="Name"> {{ file.name }} </td>
                           <td data-label="Category"> {{ file.category_id.title }} </td>
                           <td data-label="Uploader"> {{ file.user_id.full_name }}</td>
                           <td data-label="Uploaded"> {{ file.created_at }} </td>
                           <td data-label="Actions" class="actions">
                              <div class="actions--container">
                                 <div class="icon-download" title="download">
                                    <svg width="12" height="13" viewBox="0 0 12 13" fill="none"
                                       xmlns="http://www.w3.org/2000/svg">
                                       <path
                                          d="M11.25 4.75H8.25V0.25H3.75V4.75H0.75L6 10L11.25 4.75ZM0.75 11.5V13H11.25V11.5H0.75Z"
                                          fill="#777777" />
                                    </svg>
                                 </div>
                                 <div class="icon-restore" title="Restore" id="restore" data-fileid={{file.id}} data-filename="{{file.name}}">
                                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                       xmlns="http://www.w3.org/2000/svg">
                                       <path
                                          d="M13.405 1.9225L12.3625 0.6625C12.16 0.4075 11.8525 0.25 11.5 0.25H2.5C2.1475 0.25 1.84 0.4075 1.63 0.6625L0.595 1.9225C0.3775 2.1775 0.25 2.515 0.25 2.875V12.25C0.25 13.075 0.925 13.75 1.75 13.75H12.25C13.075 13.75 13.75 13.075 13.75 12.25V2.875C13.75 2.515 13.6225 2.1775 13.405 1.9225ZM7 11.125L2.875 7H5.5V5.5H8.5V7H11.125L7 11.125ZM1.84 1.75L2.4475 1H11.4475L12.1525 1.75H1.84Z"
                                          fill="#272727" fill-opacity="0.5" />
                                    </svg>
                                 </div>
                              </div>
                           </td>
                        </tr>
                        {% endfor %}
                     </tbody>
                  </table>
                  {% else %}
                  <p class="placeholder-not-found">No files yet</p>
                  {% endif %}
               </div>

               <div class="btn-dark">
                  <a href=""><span class="iconify" data-icon="akar-icons:paper" style="color: white;"></span>Print to
                     PDF</a>
               </div>



            </div>
         </section>
      </main>
   </div>

   <script src="src/js/script.js"></script>
   <script>
         $('#search').keypress(
                  function(e){
                     if (e.which == 13) {
                        var textFromInput = $("#search").val();
                        var url_mask = "{% url 'file-management:search' category_selected sort_selected 'query' %}".replace(/query/, textFromInput.toString());

                        if (textFromInput == '') {
                           url_mask = "{% url 'file-management:filter' category_selected sort_selected %}";
                        } else {
                           url_mask = "{% url 'file-management:search' category_selected sort_selected 'query' %}".replace(/query/, textFromInput.toString());
                        }

                        console.log(textFromInput);
                        window.location.replace(url_mask);
                     }
               });
      
   </script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script>

         $(document).ready(function() {
         {% if success == 1%}
        Swal.fire({
            icon: 'success',
            title: "File has been successfully uploaded!"
        })

        window.history.pushState('somedata', 'Title', '/file-management/');

        {% elif success == 2%}
        Swal.fire({
            icon: 'success',
            title: "File has been successfully updated!"
        })

        window.history.pushState('somedata', 'Title', '/file-management/');
         {% endif %}


          $(document).on('click', '#archive', function() {
             
            var file_name = $(this).data("filename");
            var file_id = $(this).data("fileid");

             Swal.fire({
                  icon: 'warning',
                  title: 'Do you want to archive ' + file_name +'?',
                  showDenyButton: true,
                  confirmButtonText: 'Yes, archive',
                  denyButtonText: `Cancel`,
                  }).then((result) => {
                  if (result.isConfirmed) {

                     var location = "{% url 'file-management:archive' 0 %}".replace(0, file_id);
                     window.location.replace(location);
                  } else if (result.isDenied) {

                  }
                  });
          });
      });


      </script>
<script>
   const toggle = document.querySelector('#sidebar--toggle');
   const sidebar = document.querySelector('#aside');
   const main = document.querySelector('#main-content');
   toggle.addEventListener('click',function(){
   if(sidebar.classList.contains('close--sidebar')){ 
   sidebar.classList.remove('close--sidebar');
   main.classList.remove('margins');
   }
   else{
   sidebar.classList.add('close--sidebar');
   main.classList.add('margins');
   }});
  </script>

</body>

</html>